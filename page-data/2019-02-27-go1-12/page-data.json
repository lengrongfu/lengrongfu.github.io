{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/2019-02-27-go1-12/",
    "result": {"data":{"site":{"siteMetadata":{"title":"LRF"}},"markdownRemark":{"id":"055486ef-7753-55cb-bef9-104d4a0e2586","excerpt":"Go1.1…","html":"<h1>Go1.12 概述</h1>\n<p><code class=\"language-text\">Go1.12</code>是目前最新的<code class=\"language-text\">Go</code>版本，在<code class=\"language-text\">Go1.11</code>发行之后的六个月到来，大多数的改变是工具链、运行时和包，总的来说，该版本依然保持了<code class=\"language-text\">Go1</code>的<a href=\"https://golang.org/doc/go1compat\">兼容性承诺</a>,希望大多数的程序还能和以前一样继续的编译和运行。</p>\n<h1>语言上的改变</h1>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">语言规范上是没有改变的。</code></pre></div>\n<h1>部分</h1>\n<ul>\n<li>竞争检测现在是支持在<code class=\"language-text\">linux/arm64</code></li>\n<li><code class=\"language-text\">Go1.12</code>是最后一个支持<code class=\"language-text\">FreeBSD 10.x</code>的版本，<code class=\"language-text\">Go1.13</code>将开始支持<code class=\"language-text\">FreeBSD 11.2+ or FreeBSD 12.0+</code>,<code class=\"language-text\"> FreeBSD 12.0+</code>要求设置一个<code class=\"language-text\">COMPAT_FREEBSD11</code>的变量，这是默认设置的。</li>\n<li>在<code class=\"language-text\">linux/ppc64</code>上支持<code class=\"language-text\">cgo</code></li>\n</ul>\n<h2>Windows</h2>\n<p><code class=\"language-text\">windows/arm</code>的部分支持<code class=\"language-text\">go</code>在<code class=\"language-text\">windows10 lot</code>的32位物联网<code class=\"language-text\">arm</code>芯片上，比如树莓派3.</p>\n<h2>AIX</h2>\n<p>Go现在支持AIX 7.2及更高版本的POWER8体系结构（aix / ppc64）。尚不支持外部链接，cgo，pprof和竞赛检测器</p>\n<h2>Darwin</h2>\n<p><code class=\"language-text\">Go 1.12</code>是最后一个支持运行在<code class=\"language-text\">macOS 10.10</code>系统之上的版本，<code class=\"language-text\">Go1.13</code>将要求操作系统必须是<code class=\"language-text\">macOS 10.11</code>以上。</p>\n<h1>工具</h1>\n<h2>go tool vet 不再支持</h2>\n<p><code class=\"language-text\">go vet</code>命令将不在支持，关于这部分功能迁移到了<code class=\"language-text\">analysis</code>工具中，更多详情查看包<a href=\"https://godoc.org/golang.org/x/tools/go/analysis\">golang.org/x/tools/go/analysis</a>,使用方式有所改变，不能再使用<code class=\"language-text\">go tool vet</code>此命令，需要更改为<code class=\"language-text\">go vet</code>命令，使用<code class=\"language-text\">go vet</code>可以支持所以的版本。\n<code class=\"language-text\">-shadow</code>将不再可用，需要替换。</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">go</span> get <span class=\"token operator\">-</span>u golang<span class=\"token punctuation\">.</span>org<span class=\"token operator\">/</span>x<span class=\"token operator\">/</span>tools<span class=\"token operator\">/</span><span class=\"token keyword\">go</span><span class=\"token operator\">/</span>analysis<span class=\"token operator\">/</span>passes<span class=\"token operator\">/</span>shadow<span class=\"token operator\">/</span>cmd<span class=\"token operator\">/</span>shadow\n<span class=\"token keyword\">go</span> vet <span class=\"token operator\">-</span>vettool<span class=\"token operator\">=</span>$<span class=\"token punctuation\">(</span>which shadow<span class=\"token punctuation\">)</span></code></pre></div>\n<h2>Tour将不在默认安装</h2>\n<p><code class=\"language-text\">Go Tour</code>不会包含再主要的包中，如果需要使用需要自行安装。</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">go</span> get <span class=\"token operator\">-</span>u golang<span class=\"token punctuation\">.</span>org<span class=\"token operator\">/</span>x<span class=\"token operator\">/</span>tour\ntour</code></pre></div>\n<h2>Build cache 要求</h2>\n<p>如果设置了<code class=\"language-text\">GOCACHE=off</code>将导致<code class=\"language-text\">go</code>命令行写缓存失败。</p>\n<h2>二进制包</h2>\n<p><code class=\"language-text\">Go 1.12</code>是最后一个支持二进制包的版本.</p>\n<h2>Cgo</h2>\n<p><code class=\"language-text\">Go1.12</code>将<code class=\"language-text\">C</code>语言的<code class=\"language-text\">EGLDisplay</code>类型翻译为<code class=\"language-text\">go</code>的<code class=\"language-text\">uintptr</code>类型。更多信息请参考<a href=\"https://golang.org/cmd/cgo/#hdr-Special_cases\">cgo 文档</a></p>\n<h1>核心库</h1>\n<h2>TLS1.3</h2>\n<p><code class=\"language-text\">Go1.12</code>添加了对<code class=\"language-text\">TLS 1.3</code>的支持，可以通过设置环境变量<code class=\"language-text\">tls13=1GODEBUG</code>来启用，在<code class=\"language-text\">Go1.13</code>版本中将默认开启。</p>\n<h2>bufio</h2>\n<p>如果在调用完<code class=\"language-text\">Peek</code>方法之后调用<code class=\"language-text\">UnreadRune and UnreadByte</code>将会返回一个错误。</p>\n<h2>bytes</h2>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">ReplaceAll</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">,</span> old<span class=\"token punctuation\">,</span> <span class=\"token builtin\">new</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">byte</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">byte</span></code></pre></div>\n<p>新函数<code class=\"language-text\">ReplaceAll</code>将返回一个字节切片的副本。<code class=\"language-text\">s</code>是原字节，<code class=\"language-text\">old</code>是匹配字节，<code class=\"language-text\">new</code>是替换为新的字符。</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\">\n<span class=\"token keyword\">package</span> main\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">(</span>\n\t<span class=\"token string\">\"bytes\"</span>\n\t<span class=\"token string\">\"fmt\"</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> bytes<span class=\"token punctuation\">.</span><span class=\"token function\">ReplaceAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token function\">byte</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"oink oink oink\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token function\">byte</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"oink\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token function\">byte</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"moo\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span>bytes<span class=\"token punctuation\">.</span><span class=\"token function\">ReplaceAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token function\">byte</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"this is a demo,place open the demo file\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token function\">byte</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"demo\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token function\">byte</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">//输出</span>\nmoo moo moo\nthis is a test<span class=\"token punctuation\">,</span>place open the test file</code></pre></div>\n<h2>crypto/rand</h2>\n<p><code class=\"language-text\">Reader.Read</code>如果超过60s还没有读取到熵，那么将会打印输出。</p>\n<h2>crypto/rc4</h2>\n<p>这个版本移除了其他版本的实现，只保留了<code class=\"language-text\">Go</code>版本。\n<code class=\"language-text\">RC4</code>是一种流<a href=\"https://zh.wikipedia.org/wiki/RC4\">加密算法</a></p>\n<h2>crypto/tls</h2>\n<p>如果客户端发送的初始消息看起来不像TLS，则服务器将不再使用警报进行回复,当TLS记录头无效时，返回<code class=\"language-text\">RecordHeaderError</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> RecordHeaderError <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Msg contains a human readable string that describes the error.</span>\n        Msg <span class=\"token builtin\">string</span>\n        <span class=\"token comment\">// RecordHeader contains the five bytes of TLS record header that</span>\n        <span class=\"token comment\">// triggered the error.</span>\n        RecordHeader <span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">byte</span>\n        <span class=\"token comment\">// Conn provides the underlying net.Conn in the case that a client</span>\n        <span class=\"token comment\">// sent an initial handshake that didn't look like TLS.</span>\n        <span class=\"token comment\">// It is nil if there's already been a handshake or a TLS alert has</span>\n        <span class=\"token comment\">// been written to the connection.</span>\n        Conn net<span class=\"token punctuation\">.</span>Conn <span class=\"token comment\">// Go 1.12</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>database/sql</h2>\n<p>现在可以通过将<code class=\"language-text\">*Rows</code>值传递给<code class=\"language-text\">Row.Scan</code>方法来获取查询光标.</p>\n<h2>expvar</h2>\n<p><code class=\"language-text\">Delete</code>方法运行删除一个<code class=\"language-text\">Map</code>类型的的<code class=\"language-text\">key</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>v <span class=\"token operator\">*</span>Map<span class=\"token punctuation\">)</span> <span class=\"token function\">Delete</span><span class=\"token punctuation\">(</span>key <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>lib/time</h2>\n<p>当操作系统未提供时区数据时，将会使用配置的<code class=\"language-text\">$GOROOT/lib/time/zoneinfo.zip</code>数据。</p>\n<h1>参考官方</h1>\n<ul>\n<li><a href=\"https://golang.org/doc/go1.12\">https://golang.org/doc/go1.12</a></li>\n</ul>","frontmatter":{"title":"go1.12 发行说明","date":"February 27, 2019","description":null}},"previous":{"fields":{"slug":"/2019-01-24-es-cluster-reroute/"},"frontmatter":{"title":"ES cluster reroute"}},"next":{"fields":{"slug":"/2019-03-16-Prometheus-1/"},"frontmatter":{"title":"Prometheus 初探一"}}},"pageContext":{"id":"055486ef-7753-55cb-bef9-104d4a0e2586","previousPostId":"bb2e560f-b4b7-5122-a190-cd22d828ab93","nextPostId":"6c59dc5d-837b-5596-953a-6879cf04a75f"}},
    "staticQueryHashes": ["2841359383","3257411868"]}