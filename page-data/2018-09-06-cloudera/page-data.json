{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/2018-09-06-cloudera/",
    "result": {"data":{"site":{"siteMetadata":{"title":"LRF"}},"markdownRemark":{"id":"e48b00ed-64f8-57e6-ab8a-690931bab7d7","excerpt":"一、准备 1、JAVA 安装 要求： 必须使用位，不能使用位. 以上版本需要用。 必须在每台集群上安装相同版本的。 必须被安装在 ,后来发现只要配置了可以在任何目录。  必须是不能是。 2、Mysql 安装  会存储一些信息到数据库中，所以需要使用,也可以使用其他，如：, 3、集群\bhostname…","html":"<h1>一、准备</h1>\n<h2>1、JAVA 安装</h2>\n<p>要求：</p>\n<ul>\n<li><code class=\"language-text\">JDK</code>必须使用<code class=\"language-text\">64</code>位，不能使用<code class=\"language-text\">32</code>位.</li>\n<li><code class=\"language-text\">cloudera5.3</code>以上版本需要用<code class=\"language-text\">JDK8</code>。</li>\n<li>必须在每台集群上安装相同版本的<code class=\"language-text\">Oracle JDK</code>。</li>\n<li><code class=\"language-text\">JDK</code>必须被安装在<code class=\"language-text\">/usr/java/jdk-(version)</code> ,后来发现只要配置了<code class=\"language-text\">JAVA_HOME</code>可以在任何目录。</li>\n<li><code class=\"language-text\">jdk</code> 必须是<code class=\"language-text\">Oracle JDK</code>不能是<code class=\"language-text\">open jdk</code>。</li>\n</ul>\n<h2>2、Mysql 安装</h2>\n<p><code class=\"language-text\">cloudera manage</code> 会存储一些信息到数据库中，所以需要使用<code class=\"language-text\">mysq</code>,也可以使用其他<code class=\"language-text\">DB</code>，如：<code class=\"language-text\">postgresql</code>,<code class=\"language-text\">mariadb</code></p>\n<h2>3、集群\bhostname配置</h2>\n<p>集群之间需要修改<code class=\"language-text\">hostname</code>,并且绑定<code class=\"language-text\">hosts</code>.使用<code class=\"language-text\">hostnamectl set-hostname hadoop-11.142.dev.net</code> 来修改主机的<code class=\"language-text\">hostname</code>，修改之后验证。</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">vim</span> /ets/hosts\nhost1 hadoop-11.142.dev.net\nhost2 hadoop-11.143.dev.net\nhost3 hadoop-11.144.dev.net\nhost4 hadoop-11.145.dev.net\nhost5 hadoop-11.146.dev.net</code></pre></div>\n<h2>4、ssh 免密登陆配置</h2>\n<p><code class=\"language-text\">cloudera manage</code>需要访问和分发数据到<code class=\"language-text\">salve</code>节点,所以需要<code class=\"language-text\">ssh</code>免密登陆，只需要<code class=\"language-text\">manage</code>节点能免密登陆到<code class=\"language-text\">salve</code>节点即可.配置步骤如下。</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"> <span class=\"token comment\"># 在manage节点上配置,先清除所以节点上的.ssh文件夹下的内容</span>\n$ ssh-keygen <span class=\"token comment\"># 生成公钥和似钥</span>\n$ ssh-copy-id hadoop-11.142.dev.net <span class=\"token comment\">#拷贝公钥到其他集群上，首先拷贝到自己上面，重复执行上面的步骤，直到拷贝完所有的节点。</span>\n$ <span class=\"token function\">ssh</span> hadoop-11.143.dev.net <span class=\"token comment\">#检验是否可以实现免密登陆。</span></code></pre></div>\n<h2>5、安装所需模块和系统设置</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ yum <span class=\"token function\">install</span> psmisc \n<span class=\"token comment\"># 每一台宿主机都要设置</span>\n$ <span class=\"token builtin class-name\">echo</span> never <span class=\"token operator\">></span> /sys/kernel/mm/transparent_hugepage/defrag\n$ <span class=\"token builtin class-name\">echo</span> never <span class=\"token operator\">></span> /sys/kernel/mm/transparent_hugepage/enabled\n$ <span class=\"token builtin class-name\">echo</span> <span class=\"token number\">10</span> <span class=\"token operator\">>></span> /proc/sys/vm/swappiness <span class=\"token comment\">#</span></code></pre></div>\n<h2>6、下载parcel</h2>\n<p>此处下载是为了使用离线安装，不然安装的时候再下载，如果网络不好就会出现多次安装都没有不成功。此处下载比较耗时，可以先进行下载，下载存放目录可以任意，安装时可以指定。</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">wget</span> -c http://archive.cloudera.com/cdh5/parcels/5.12/CDH-5.12.2-1.cdh5.12.2.p0.4-el7.parcel\n$ <span class=\"token function\">wget</span> -c http://archive.cloudera.com/cdh5/parcels/5.12/CDH-5.12.2-1.cdh5.12.2.p0.4-el7.parcel.sha1\n$ <span class=\"token function\">wget</span> -c http://archive.cloudera.com/cdh5/parcels/5.12/manifest.json</code></pre></div>\n<h1>二、安装</h1>\n<h2>1、 Cloudera Manager Server 安装</h2>\n<p>上面的准备工作都完成了之后就可以进行下载安装了，</p>\n<h2>1、命令安装</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> cloudera-manager-daemons cloudera-manager-agent cloudera-manager-server</code></pre></div>\n<h2>2、下载manager</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># http://archive.cloudera.com/cm5/cm/5/</span>\n$ <span class=\"token function\">wget</span> -c http://archive.cloudera.com/cm5/cm/5/cloudera-manager-centos7-cm5.12.2_x86_64.tar.gz\n$ <span class=\"token function\">tar</span> -zxf cloudera-manager-centos7-cm5.12.2_x86_64.tar.gz\n$ <span class=\"token builtin class-name\">cd</span> ./cm-5.12.2</code></pre></div>\n<h2>3、下载mysql-connector-java</h2>\n<p>下载<code class=\"language-text\">mysql-connector-java</code>并放入<code class=\"language-text\">/usr/local/cloudera/cm-5.12.2/share/cmf/lib</code>路径中,</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">wget</span> -c https://cdn.mysql.com//Downloads/Connector-J/mysql-connector-java-8.0.12.tar.gz\n$ <span class=\"token function\">tar</span> -zxf mysql-connector-java-8.0.12.tar.gz \n$ <span class=\"token builtin class-name\">cd</span> mysql-connector-java-8.0.12\n$ <span class=\"token function\">cp</span> mysql-connector-java-8.0.12.jar /usr/local/cloudera/cm-5.12.2/share/cmf/lib</code></pre></div>\n<h2>4、创建db</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token builtin class-name\">cd</span> ./cm-5.12.2/share/cmf/schema\n<span class=\"token comment\"># https://www.cloudera.com/documentation/enterprise/6/6.0/topics/prepare_cm_database.html 次命令有很多参数，具体参考</span>\n$ <span class=\"token function\">bash</span> scm_prepare_database.sh mysql cm root password <span class=\"token comment\"># 执行命令，创建db</span></code></pre></div>\n<h2>5、修改agent配置</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token builtin class-name\">cd</span> ./etc/cloudera-scm-agent/\n$ <span class=\"token function\">vim</span> config.ini\n<span class=\"token comment\"># Hostname of the CM server.</span>\n<span class=\"token assign-left variable\">server_host</span><span class=\"token operator\">=</span>hadoop-11.142.dev.net</code></pre></div>\n<h2>6、把agent分发到其他机器上</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">tar</span> -zcf cm-5.12.2.tar.gz cm-5.12.2/\n$ <span class=\"token function\">scp</span> cm-5.12.2.tar.gz root@host2:/usr/local/cloudera\n$ <span class=\"token function\">scp</span> cm-5.12.2.tar.gz root@host3:/usr/local/cloudera\n$ <span class=\"token function\">scp</span> cm-5.12.2.tar.gz root@host4:/usr/local/cloudera\n$ <span class=\"token function\">scp</span> cm-5.12.2.tar.gz root@host5:/usr/local/cloudera</code></pre></div>\n<h2>7、启动manage</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 添加用户</span>\n$ <span class=\"token function\">useradd</span> --system --home<span class=\"token operator\">=</span>/usr/local/cloudera/cm-5.12.2/run/cloudera-scm-server/ --no-create-home --shell<span class=\"token operator\">=</span>/bin/false --comment <span class=\"token string\">\"Cloudera SCM User\"</span> cloudera-scm\n$ <span class=\"token builtin class-name\">cd</span> ./cm-5.12.2/run/cloudera-scm-server\n$ ./cm-5.12.2/etc/init.d/cloudera-scm-server start</code></pre></div>\n<h2>8、启动agent</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ ./cm-5.12.2/etc/init.d/cloudera-scm-agent start\n</code></pre></div>\n<h2>9、启动hadoop集群</h2>\n<p>浏览器中访问<code class=\"language-text\">manage</code>服务器的<code class=\"language-text\">ip:port</code>,<code class=\"language-text\">http://host1:7180/</code>,密码账号为<code class=\"language-text\">admin/amdin</code>.进入执行页面</p>\n<p><img src=\"1.png\" alt=\"1\">\n<img src=\"2.png\" alt=\"2\">\n<img src=\"3.png\" alt=\"3\">\n<img src=\"4.png\" alt=\"4\">\n<img src=\"5.png\" alt=\"5\"></p>\n<p>如果<code class=\"language-text\">Parcel</code>没有存放在<code class=\"language-text\">/opt/cloudera/parcels</code> 这个目录，就可以修改为自己存放文件的路径，需要修改一个文件名<code class=\"language-text\">cp CDH-5.12.2-1.cdh5.12.2.p0.4-el7.parcel.sha1 CDH-5.12.2-1.cdh5.12.2.p0.4-el7.parcel.sha</code>,把<code class=\"language-text\">sha1</code>文件改为<code class=\"language-text\">sha</code>,之后的都默认一直继续。</p>\n<p><img src=\"6.png\" alt=\"6\">\n如果有警告，需要解决警告，上面有提示解决方法，如果没有警告就继续执行下一步。</p>\n<p><img src=\"7.png\" alt=\"7\">\n可以自定义选择安装的软件。</p>\n<p><img src=\"8.png\" alt=\"8\">\n通过自己服务的情况，来分配角色，除了<code class=\"language-text\">manage servie</code>不能修改。</p>\n<p><img src=\"9.png\" alt=\"9\"></p>\n<p>连接之前安装的mysql，要有能连接上的权限的账号和密码。写完之后可以测试连接一下。在安装过程中会出现<code class=\"language-text\">hive</code>和<code class=\"language-text\">Ooize</code>没有数据库连接的包报错，此时需要把之前下载好的<code class=\"language-text\">jar</code>包分发到<code class=\"language-text\">hive</code>和<code class=\"language-text\">Ooize</code>的主机上去。</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># hive 主机在配置角色页面上指定</span>\n$ <span class=\"token function\">scp</span> mysql-connector-java-8.0.12.jar root@host5:/opt/cloudera/parcels/CDH/lib/hive/lib\n<span class=\"token comment\"># oozie 主机在配置角色页面上指定</span>\n$ <span class=\"token function\">scp</span> mysql-connector-java-8.0.12.jar root@host3:/var/lib/oozie</code></pre></div>\n<p><img src=\"10.png\" alt=\"10\">\n<img src=\"11.png\" alt=\"11\"></p>\n<h1>三、 下载地址</h1>\n<ul>\n<li><a href=\"http://archive.cloudera.com/cm5/cm/5/\">cloudera manage</a></li>\n<li><a href=\"http://archive.cloudera.com/cdh5/parcels/5.12/\">CDH </a></li>\n</ul>\n<h1>四、参考</h1>\n<ul>\n<li><a href=\"https://blog.csdn.net/mergerly/article/details/75127392\">https://blog.csdn.net/mergerly/article/details/75127392</a></li>\n<li><a href=\"http://www.cnblogs.com/lion.net/p/5477899.html\">http://www.cnblogs.com/lion.net/p/5477899.html</a></li>\n</ul>","frontmatter":{"title":"cloudera hadoop 安装","date":"September 06, 2018","description":null}},"previous":{"fields":{"slug":"/2018-09-03-搭建一个自己的blog/"},"frontmatter":{"title":"搭建一个自己的blog"}},"next":{"fields":{"slug":"/2018-09-11-Sqoop/"},"frontmatter":{"title":"Sqoop User Guide(Sqoop使用指南)"}}},"pageContext":{"id":"e48b00ed-64f8-57e6-ab8a-690931bab7d7","previousPostId":"d4cbbdd4-2b7c-5d42-bb83-c14d0c02f7de","nextPostId":"190ee72d-5e39-5eb8-bac7-160d321a64ef"}},
    "staticQueryHashes": ["2841359383","3257411868"]}