{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/2018-10-17-es-xpack-install/",
    "result": {"data":{"site":{"siteMetadata":{"title":"LRF"}},"markdownRemark":{"id":"c67bfda4-f0f6-539d-b5e5-5f482a7b2c2b","excerpt":"假如已经有和了。 下面的为安装路径. 1、下载xpakc 2、Elasticsearch安装X-Pack 安装有两种方法。 一、手动安装 安装插件 破解 编译 替换class文件 申请license 修改license ps…","html":"<p>假如已经有<code class=\"language-text\">es</code>和<code class=\"language-text\">kibana</code>了。</p>\n<p>下面的为安装路径.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">esHome=/data/home/elastic/elasticsearch-5.4.3\nxpackHome=/data/home/xpack\nkibanaHome=/data/home/kibana</code></pre></div>\n<h2>1、下载xpakc</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 下载xpack压缩包</span>\n$ <span class=\"token builtin class-name\">cd</span> <span class=\"token variable\">${xpackHome}</span>\n$ <span class=\"token function\">wget</span> -c 'https://artifacts.elastic.co/downloads/packs/x-pack/x-pack-5.4.3.zip\n</code></pre></div>\n<h2>2、Elasticsearch安装X-Pack</h2>\n<p><code class=\"language-text\">ES</code>安装<code class=\"language-text\">x-pack</code>有两种方法。</p>\n<h3>一、手动安装</h3>\n<ul>\n<li>安装插件</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ ./bin/elasticsearch-plugin <span class=\"token function\">install</span> file://<span class=\"token variable\">${xpackHome}</span>/x-pack-5.4.3.zip</code></pre></div>\n<ul>\n<li>破解<code class=\"language-text\">xpack</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token builtin class-name\">cd</span> <span class=\"token variable\">${esHome}</span>/plugins\n$ <span class=\"token function\">touch</span> LicenseVerifier.java\n$ <span class=\"token function\">vim</span> LicenseVerifier.java\n\npackage org.elasticsearch.license<span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">import</span> java.nio.*<span class=\"token punctuation\">;</span>\n<span class=\"token function\">import</span> java.util.*<span class=\"token punctuation\">;</span>\n<span class=\"token function\">import</span> java.security.*<span class=\"token punctuation\">;</span>\n<span class=\"token function\">import</span> org.elasticsearch.common.xcontent.*<span class=\"token punctuation\">;</span>\n<span class=\"token function\">import</span> org.apache.lucene.util.*<span class=\"token punctuation\">;</span>\n<span class=\"token function\">import</span> org.elasticsearch.common.io.*<span class=\"token punctuation\">;</span>\n<span class=\"token function\">import</span> java.io.*<span class=\"token punctuation\">;</span>\n\npublic class LicenseVerifier\n<span class=\"token punctuation\">{</span>\n    public static boolean verifyLicense<span class=\"token punctuation\">(</span>final License license, final byte<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> encryptedPublicKeyData<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token builtin class-name\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    public static boolean verifyLicense<span class=\"token punctuation\">(</span>final License license<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token builtin class-name\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<ul>\n<li>编译</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token builtin class-name\">cd</span> <span class=\"token variable\">${esHome}</span>/plugins\n$ javac -cp <span class=\"token string\">\"<span class=\"token variable\">${esHome}</span>/lib/elasticsearch-5.4.3.jar:<span class=\"token variable\">${esHome}</span>/lib/lucene-core-6.5.1.jar:<span class=\"token variable\">${esHome}</span>/plugins/x-pack/x-pack-5.4.3.jar\"</span> LicenseVerifier.java\n</code></pre></div>\n<ul>\n<li>替换class文件</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 解压</span>\n$ <span class=\"token builtin class-name\">cd</span> <span class=\"token variable\">${esHome}</span>/plugins/x-pack/\n<span class=\"token function\">mkdir</span> <span class=\"token builtin class-name\">test</span>\n<span class=\"token function\">mv</span> x-pack-5.4.3.jar test/\n<span class=\"token builtin class-name\">cd</span> test/\njar xvf x-pack-5.4.3.jar\n<span class=\"token comment\">#替换</span>\n<span class=\"token builtin class-name\">cd</span> ./org/elasticsearch/license\n<span class=\"token function\">rm</span> -f LicenseVerifier.class\n<span class=\"token function\">mv</span> <span class=\"token variable\">${esHome}</span>/plugins/LicenseVerifier.class <span class=\"token builtin class-name\">.</span>\n<span class=\"token comment\"># 打包</span>\n<span class=\"token builtin class-name\">cd</span> <span class=\"token variable\">${esHome}</span>/plugins/x-pack/test\njar cvf x-pack-5.4.3.jar <span class=\"token builtin class-name\">.</span>\n<span class=\"token function\">mv</span> x-pack-5.4.3.jar <span class=\"token punctuation\">..</span>/\n<span class=\"token comment\">#删除临时文件</span>\n<span class=\"token builtin class-name\">cd</span> <span class=\"token punctuation\">..</span>/\n<span class=\"token function\">rm</span> -rf <span class=\"token builtin class-name\">test</span>\n<span class=\"token builtin class-name\">cd</span> <span class=\"token punctuation\">..</span>/\n<span class=\"token function\">rm</span> LicenseVerifier.java</code></pre></div>\n<ul>\n<li>申请license</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\">#来此注册，并下载license文件</span>\nhttps://license.elastic.co/registration</code></pre></div>\n<ul>\n<li>修改license</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>                                                                                                                                                                                                       \n       <span class=\"token property\">\"license\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n           <span class=\"token property\">\"uid\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"01957577-fa6e-426f-9257-200ccdfaee73\"</span><span class=\"token punctuation\">,</span>\n           <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"platinum\"</span><span class=\"token punctuation\">,</span>\n           <span class=\"token property\">\"issue_date_in_millis\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1534464000000</span><span class=\"token punctuation\">,</span>\n           <span class=\"token property\">\"expiry_date_in_millis\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2524579200999</span><span class=\"token punctuation\">,</span>\n           <span class=\"token property\">\"max_nodes\"</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span>\n           <span class=\"token property\">\"issued_to\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"leng rongfu (no)\"</span><span class=\"token punctuation\">,</span>\n           <span class=\"token property\">\"issuer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Web Form\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"signature\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"AAAAAwAAAA0p6LA0HKNGcIOkCCRqAAABmC9ZN0hjZDBGYnVyRXpCOW5Bb3FjZDAxOWpSbTVoMVZwUzRxVk1PSmkxaktJRVl5MUYvUWh3bHZVUTllbXNPbzBUemtnbWpBbmlWRmRZb25KNFlBR2x0TXc2K2p1Y1VtMG1UQU9TRGZVSGRwaE   JGUjE3bXd3LzRqZ05iLzRteWFNekdxRGpIYlFwYkJiNUs0U1hTVlJKNVlXekMrSlVUdFIvV0FNeWdOYnlESDc3MWhlY3hSQmdKSjJ2ZTcvYlBFOHhPQlV3ZHdDQ0tHcG5uOElCaDJ4K1hob29xSG85N0kvTWV3THhlQk9NL01VMFRjNDZpZEVXeUtUMXIyMlIveFpJUk    k2WUdveEZaME9XWitGUi9WNTZVQW1FMG1DenhZU0ZmeXlZakVEMjZFT2NvOWxpZGlqVmlHNC8rWVVUYzMwRGVySHpIdURzKzFiRDl4TmM1TUp2VTBOUlJZUlAyV0ZVL2kvVk10L0NsbXNFYVZwT3NSU082dFNNa2prQ0ZsclZ4NTltbU1CVE5lR09Bck93V2J1Y3c9PQ    AAAQBENsHqhC2OW/yYxaKP5tS/GHT9TrEbcEtI62k//Id9p2DzSHUv+xekDbfiu550wMrBnoeOi4xV4X6C2WcJCYLSM/QRTotlm11SGvWnUgRXFst83n/nceh3l3Y9D3Odec4zAhrhrYynisls2WfCFGSEW5EUO1II+3C5xhyKMyLROlAxkwNco0H4zD3GlEjZNqC3CK    8cQRRmeJ1lIPvb/Tw8JbbG5zjQuYhQakMAbXqIeL9BLla7sAP4+M8lmvh4Z6bwUGy1MQ9j1+ijdswWMNVs8Vr7CnxZ1j4pla2ZWkGSr4sNfI0LF6U25HC4ofb8CQkrKoAq80EPdINnrfyr56CU\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"start_date_in_millis\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1534464000000</span>\n      <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"license\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"uid\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"01957577-fa6e-426f-9257-200ccdfaee73\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"platinum\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"issue_date_in_millis\"</span><span class=\"token operator\">:</span><span class=\"token number\">1534464000000</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"expiry_date_in_millis\"</span><span class=\"token operator\">:</span><span class=\"token number\">2524579200999</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"max_nodes\"</span><span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"issued_to\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"leng rongfu (no)\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"issuer\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"Web Form\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"signature\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"AAAAAwAAAA0p6LA0HKNGcIOkCCRqAAABmC9ZN0hjZDBGYnVyRXpCOW5Bb3FjZDAxOWpSbTVoMVZwUzRxVk1PSmkxaktJRVl5MUYvUWh3bHZVUTllbXNPbzBUemtnbWpBbmlWRmRZb25KNFlBR2x0TXc2K2p1Y1VtMG1UQU9TRGZVSGRwaEJGUjE3bXd3LzRqZ05iLzRteWFNekdxRGpIYlFwYkJiNUs0U1hTVlJKNVlXekMrSlVUdFIvV0FNeWdOYnlESDc3MWhlY3hSQmdKSjJ2ZTcvYlBFOHhPQlV3ZHdDQ0tHcG5uOElCaDJ4K1hob29xSG85N0kvTWV3THhlQk9NL01VMFRjNDZpZEVXeUtUMXIyMlIveFpJUkk2WUdveEZaME9XWitGUi9WNTZVQW1FMG1DenhZU0ZmeXlZakVEMjZFT2NvOWxpZGlqVmlHNC8rWVVUYzMwRGVySHpIdURzKzFiRDl4TmM1TUp2VTBOUlJZUlAyV0ZVL2kvVk10L0NsbXNFYVZwT3NSU082dFNNa2prQ0ZsclZ4NTltbU1CVE5lR09Bck93V2J1Y3c9PQAAAQBENsHqhC2OW/yYxaKP5tS/GHT9TrEbcEtI62k//Id9p2DzSHUv+xekDbfiu550wMrBnoeOi4xV4X6C2WcJCYLSM/QRTotlm11SGvWnUgRXFst83n/nceh3l3Y9D3Odec4zAhrhrYynisls2WfCFGSEW5EUO1II+3C5xhyKMyLROlAxkwNco0H4zD3GlEjZNqC3CK8cQRRmeJ1lIPvb/Tw8JbbG5zjQuYhQakMAbXqIeL9BLla7sAP4+M8lmvh4Z6bwUGy1MQ9j1+ijdswWMNVs8Vr7CnxZ1j4pla2ZWkGSr4sNfI0LF6U25HC4ofb8CQkrKoAq80EPdINnrfyr56CU\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"start_date_in_millis\"</span><span class=\"token operator\">:</span><span class=\"token number\">1534464000000</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ps：<code class=\"language-text\">platinum</code>表示白金版，可以使用所有功能。其他的如<code class=\"language-text\">expiry_date_in_millis</code>、<code class=\"language-text\">max_nodes</code>等根据自己需要修改即可,<code class=\"language-text\">expiry_date_in_millis</code>是过期时间,使用的是<code class=\"language-text\">uninx时间</code>,我设置的是到<code class=\"language-text\">2049</code>年.</p>\n<ul>\n<li>查看lience</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">curl</span> -XGET -u elastic:changeme <span class=\"token string\">'http://{host}:9200/_license'</span></code></pre></div>\n<ul>\n<li>注册新修改的lience</li>\n<li></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">curl</span> -XPUT -u elastic:changeme <span class=\"token string\">'http://{host}:9200/_xpack/license?acknowledge=true'</span> -d @lience.json</code></pre></div>\n<h3>二、直接导入文件</h3>\n<p>如果有破解好的文件，直接把<code class=\"language-text\">plugins</code>下的<code class=\"language-text\">x-pack</code>文件夹进行压缩，复制到其它节点的<code class=\"language-text\">plugins</code>路径下，重启就可以使用。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\n# 下载地址\n$ wget -c https://note.youdao.com/yws/api/personal/file/WEBe693b8fab3b4cad482e5b354cd4176cd?method=download&amp;shareKey=a16d1e40a0ec4461a4f619f325c3f150\n</code></pre></div>\n<h2>3、kibana安装X-Pack</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token builtin class-name\">cd</span> <span class=\"token variable\">${kibanaHome}</span>\n$ ./bin/kibana-plugin <span class=\"token function\">install</span> file://<span class=\"token variable\">${xpackHome}</span>/x-pack-5.4.3.zip\n</code></pre></div>\n<h1>参考文档</h1>\n<ul>\n<li><a href=\"https://my.oschina.net/guol/blog/1204258\">https://my.oschina.net/guol/blog/1204258</a></li>\n<li><a href=\"https://mp.weixin.qq.com/s/NN01SalzLz2Ue6Q4exCfAw\">https://mp.weixin.qq.com/s/NN01SalzLz2Ue6Q4exCfAw</a></li>\n</ul>","frontmatter":{"title":"ES X-Pack 5.4.3破解安装","date":"October 17, 2018","description":null}},"previous":{"fields":{"slug":"/2018-10-16-cloudera-problem/"},"frontmatter":{"title":"cloudera 问题解决"}},"next":{"fields":{"slug":"/2018-10-17-es-xpack-watch-user/"},"frontmatter":{"title":"es-xpack-watch-user"}}},"pageContext":{"id":"c67bfda4-f0f6-539d-b5e5-5f482a7b2c2b","previousPostId":"cd3b5f76-78e9-5d38-bca8-83d1126a6d8f","nextPostId":"a5dbd2cc-2d87-5816-90b7-c112ccb62043"}},
    "staticQueryHashes": ["2841359383","3257411868"]}